<!DOCTYPE html>
<html class="loading" lang="en" data-textdirection="ltr">
<%- include('../common/header.ejs'); %>

    <body class="vertical-layout vertical-menu-modern navbar-floating footer-static" data-open="click"
        data-menu="vertical-menu-modern" data-col="">
        <%- include('../common/navbar.ejs'); %>
            <%- include('../common/sidebar.ejs'); %>


                <div class="app-content content">
                    <div class="content-overlay"></div>
                    <div class="header-navbar-shadow"></div>
                    <div class="content-wrapper">
                        <div class="content-body">
                            <div class="auth-wrapper">
                                <div class="auth-inner py-2">
                                    <div class="card mb-0">
                                        <div class="card-body">
                                            <form id="validate" class="auth-register-form" action="/createuser"
                                                method="POST" enctype="multipart/form-data" novalidate>
                                                <div class="mb-1 col-3">
                                                    <label for="image" class="form-label">Image</label>
                                                    <div id="imagePreview" style="margin-bottom: 0px;">
                                                        <img id="preview" class='mb-2' src="" alt="Preview Image"
                                                            style="display: none; width: 295px; height: 200px; object-fit: cover; border: 1px solid #ddd; border-radius: 5px;" />
                                                    </div>

                                                    <input type="file" class="form-control" id="image" name="image"
                                                    aria-describedby="image" tabindex="1"
                                                    onchange="previewImage(event)" required />
                                                

                                                    <div class="invalid-feedback">
                                                        This field is required
                                                    </div>
                                                </div>




                                                <div class="row">
                                                    <div class="mb-1 col-md-6">
                                                        <label for="workGroup" class="form-label">Name</label>
                                                        <input type="text" class="form-control" id="name" name="name"
                                                            required
                                                            oninput="this.value = this.value.replace(/^\s+/g, '');"
                                                            minlength="2" maxlength="20" />
                                                        <div class="invalid-feedback">Please enter a name.</div>
                                                    </div>

                                                    <div class="mb-1 col-md-6">
                                                        <label for="workGroupCode" class="form-label">Email</label>
                                                        <input type="email" class="form-control" id="email" name="email"
                                                            required
                                                            oninput="this.value = this.value.replace(/^\s+/g, '');"
                                                            minlength="2" maxlength="20" />
                                                        <div class="invalid-feedback">Please enter a email.</div>
                                                    </div>

                                                    <div class="mb-1 col-md-6">
                                                        <label for="workGroupCode" class="form-label">Location</label>
                                                        <input type="text" class="form-control" id="location"
                                                            name="location" required
                                                            oninput="this.value = this.value.replace(/^\s+/g, '');"
                                                            minlength="2" maxlength="20" />
                                                        <div class="invalid-feedback">Please enter a location.</div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <label class="form_label" for="phone">Phone Number</label>
                                                        <div class="d-flex mb-1 ">
                                                            <div class="col-4 pe-2">
                                                                <select id="countryCode" name="countryCode"
                                                                    class="form-control" required>
                                                                    <%- include('./countryCodes') %>
                                                                </select>
                                                                <div class="invalid-feedback">Select country code.</div>
                                                            </div>
                                                            <div class="col-8">
                                                                <input type="number" id="phoneNumber" name="phoneNumber"
                                                                    maxlength="15" class="form-control"
                                                                    placeholder="Phone Number" required
                                                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');" />
                                                                <div class="invalid-feedback">Valid phone number
                                                                    required.
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="mb-1 col-md-6">
                                                        <div class="inputgroup ">
                                                            <label for="">Password</label>
                                                            <input type="password" id="password" name="password"
                                                                autocomplete="new-password" maxlength="50"
                                                                class="form-control" placeholder="*************"
                                                                required minlength="4
                                                            " />
                                                            <button type="button" class="eye-btn"
                                                                onclick="togglePassword('password', 'eyeIcon1')">
                                                                <i id="eyeIcon1" class="fa fa-eye"></i>
                                                            </button>
                                                            <div class="invalid-feedback absolute">Password is required.
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="mb-1 col-md-6">
                                                        <div class="inputgroup ">
                                                            <label for="">Confirm Password</label>
                                                            <input type="password" id="confirm_password"
                                                                name="confirm_password" maxlength="50"
                                                                class="form-control" placeholder="*************"
                                                                required minlength="4" />
                                                            <button type="button" class="eye-btn"
                                                                onclick="togglePassword('confirm_password', 'eyeIcon2')">
                                                                <i id="eyeIcon2" class="fa fa-eye"></i>
                                                            </button>
                                                            <div class="invalid-feedback">Please confirm your password.
                                                            </div>
                                                        </div>
                                                    </div>


                                                    <div class="d-flex justify-content-end">
                                                        <button type="submit"
                                                            class="btn btn-primary mx-2">Update</button>
                                                        <a class="btn btn-primary" href="/employeelist">Back</a>
                                                    </div>
                                            </form>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <script src="../../../app-assets/vendors/js/vendors.min.js"></script>
                <script src="../../../app-assets/js/core/app-menu.js"></script>
                <script src="../../../app-assets/js/core/app.js"></script>


                    <script>
                        (function () {
                            'use strict';
                            var form = document.getElementById('validate');

                            form.addEventListener('submit', function (event) {
                                if (!form.checkValidity()) {
                                    event.preventDefault();
                                    event.stopPropagation();
                                }
                                form.classList.add('was-validated');
                            }, false);
                        })();
                    </script>


                    <script>
                        function previewImage(event) {
                            const preview = document.getElementById('preview');
                            const fileInput = event.target;
                            const file = fileInput.files[0];

                            const allowedTypes = ['image/jpeg', 'image/png', 'image/jpg'];
                            const maxSize = 2 * 1024 * 1024; // 2MB

                            if (file) {
                                if (!allowedTypes.includes(file.type)) {
                                    fileInput.setCustomValidity('Only JPG, JPEG, and PNG files are allowed.');
                                    preview.style.display = 'none';
                                    return;
                                } else if (file.size > maxSize) {
                                    fileInput.setCustomValidity('Image size must be less than 2MB.');
                                    preview.style.display = 'none';
                                    return;
                                } else {
                                    fileInput.setCustomValidity('');
                                }

                                const reader = new FileReader();

                                reader.onload = function (e) {
                                    preview.src = e.target.result;
                                    preview.style.display = 'block';
                                };

                                reader.readAsDataURL(file);
                            } else {
                                preview.style.display = 'none';
                            }
                        }
                    </script>

                    <script>
                        feather.replace(); 
                    </script>
                    <script>
                        function togglePassword(inputId, iconId) {
                            var input = document.getElementById(inputId);
                            var icon = document.getElementById(iconId);

                            if (input.type === "password") {
                                input.type = "text";
                                icon.classList.replace("fa-eye", "fa-eye-slash");
                            } else {
                                input.type = "password";
                                icon.classList.replace("fa-eye-slash", "fa-eye");
                            }
                        }
                    </script>
                    <script>
                        (function () {
                            'use strict';

                            window.addEventListener('load', function () {
                                var form = document.getElementById('validate');
                                var password = document.getElementById('password');
                                var confirmPassword = document.getElementById('confirm_password');

                                form.addEventListener('submit', function (event) {
                                    if (!form.checkValidity()) {
                                        event.preventDefault();
                                        event.stopPropagation();
                                    }

                                    if (password.value !== confirmPassword.value) {
                                        event.preventDefault();
                                        event.stopPropagation();
                                        confirmPassword.setCustomValidity('Confirm password does not match.');
                                    } else {
                                        confirmPassword.setCustomValidity('');
                                    }

                                    form.classList.add('was-validated');
                                }, false);
                            });


                        })();
                    </script>

                    <style>
                        .eye-btn {
                            background: none;
                            border: none;
                            cursor: pointer;
                            position: absolute;
                            right: 20px;
                            top: 87%;

                            transform: translateY(-100%);
                        }

                        .inputgroup {
                            position: relative;
                        }

                        button.eye-btn {
                            position: absolute;
                            top: 52px;
                            right: 25px;
                        }
                    </style>

                    <script>
                        function previewImage(event) {
                            const preview = document.getElementById('preview');
                            const file = event.target.files[0];

                            if (file) {
                                const reader = new FileReader();

                                reader.onload = function (e) {
                                    preview.src = e.target.result;
                                    preview.style.display = 'block';
                                };

                                reader.readAsDataURL(file);
                            } else {
                                preview.style.display = 'none';
                            }
                        }
                    </script>
    </body>

</html>